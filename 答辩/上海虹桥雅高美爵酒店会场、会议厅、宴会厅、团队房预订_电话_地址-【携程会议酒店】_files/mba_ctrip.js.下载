/*! 2016-4-20_13:55:7 chenwp@ctrip.com */
!function(){try{var mediav=window.mediav||{};if(window.mediav=mediav,mediav.test=function(tag){},window.mediav.mba_lite)return;window.mediav.mba_lite=1,mediav.cookie={},mediav.$version="3.3.ctrip.17",mediav.cookie._isValidKey=function(key){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(key)},mediav.cookie.getRaw=function(key){if(mediav.cookie._isValidKey(key)){var reg=new RegExp("(^| )"+key+"=([^;]*)(;|$)"),result=reg.exec(document.cookie);if(result)return result[2]||null}return null},mediav.cookie.get=function(key){var value=mediav.cookie.getRaw(key);if("string"==typeof value){try{value=decodeURIComponent(value)}catch(e){}return value}return null},mediav.cookie.setRaw=function(key,value,options){options=options||{};var expires=options.expires;"number"==typeof options.expires&&(expires=new Date,expires.setTime(expires.getTime()+options.expires)),document.cookie=key+"="+value+(options.path?"; path="+options.path:"/")+(expires?"; expires="+expires.toGMTString():"")+(options.domain?"; domain="+options.domain:"")+(options.secure?"; secure":"")},mediav.cookie.remove=function(key,options){options=options||{},options.expires=new Date(0),mediav.cookie.setRaw(key,"",options)},mediav.cookie.set=function(key,value,options){mediav.cookie.setRaw(key,encodeURIComponent(value),options)},mediav.oOrganic=function(srcName,keyword){this.srcName=srcName,this.keyword=keyword},mediav.cOrganics=[new mediav.oOrganic("baidu","word"),new mediav.oOrganic("baidu","wd"),new mediav.oOrganic("google","q"),new mediav.oOrganic("sogou","query"),new mediav.oOrganic("zhongsou","w"),new mediav.oOrganic("soso","w"),new mediav.oOrganic("search.114.vnet.cn","kw"),new mediav.oOrganic("youdao","q"),new mediav.oOrganic("gougou","search"),new mediav.oOrganic("bing","q"),new mediav.oOrganic("msn","q"),new mediav.oOrganic("live","q"),new mediav.oOrganic("aol","query"),new mediav.oOrganic("aol","q"),new mediav.oOrganic("aol","encquery"),new mediav.oOrganic("lycos","query"),new mediav.oOrganic("ask","q"),new mediav.oOrganic("altavista","q"),new mediav.oOrganic("netscape","query"),new mediav.oOrganic("cnn","query"),new mediav.oOrganic("looksmart","qt"),new mediav.oOrganic("about","terms"),new mediav.oOrganic("pchome","q")],mediav.queryToJson=function(url){var json={},params=url.split("?");params.shift();var query=params.shift();if(params.length>=1)var last=params.join("?");var query=url.split("?")[1];if(query){query=query.split("&");for(var i=0,l=query.length;l>i;i++){var v=query[i].split("=");json[v[0]]=v[1],last&&i==l-1&&(json[v[0]]=v[1]+"?"+last)}}return json},mediav.createCampaignSource=function(qJson){var mvsrc=qJson._mvsrc||qJson._mvmix,mvcam=qJson._mvcam;return mvsrc?new mediav.sourceX("(camp)",mvsrc,mvcam):void 0},mediav.createSearchSource=function(ref){if(!(null==ref||ref.indexOf("://")<0))for(var GetAuthorityFromUrl=function(url){var u="";return u=url.split("://")[1],u.indexOf("/")>=0&&(u=u.split("/")[0]),u},authority=GetAuthorityFromUrl(ref),orgs=mediav.cOrganics,refJson=mediav.queryToJson(ref),i=0,l=orgs.length;l>i;i++){var orgItem=orgs[i];if(authority.indexOf(orgItem.srcName)>=0){var keyword=refJson[orgItem.keyword];if(keyword)return new mediav.sourceX("(search)",orgItem.srcName,keyword)}}},mediav.createRefSource=function(ref){if(!(null==ref||ref.indexOf("://")<0)){var dom=ref.split("://")[1].toLowerCase();if(dom.indexOf("/")>=0){var path=dom.substring(dom.indexOf("/"));path.indexOf("?")>=0&&(path=path.split("?")[0]),dom=dom.split("/")[0]}return 0==dom.indexOf("www.")&&(dom=dom.substring(4)),new mediav.sourceX("(ref)",dom,path||"")}},mediav.sourceX=function(type,srcName,content){this.srcName=srcName.replace(/\./g,"%2E").replace(/\|/g,"%7C"),this.content=content.replace(/\./g,"%2E").replace(/\|/g,"%7C")},mediav.updateSingleSource=function(srckey,value,oSrc,stamp,fNewSession){if(oSrc){var srcStr="jzqsr="+oSrc.srcName+"|jzqct="+oSrc.content,srcArr=value.split(".");return srcArr.length<6?(srcArr[0]=1,srcArr[1]=stamp,srcArr[2]=stamp,srcArr[3]=1,srcArr[4]="jzqsr="+oSrc.srcName+"|jzqct="+oSrc.content,srcArr[5]=srcArr[4]):srcArr[4]!=srcStr&&(srcArr[3]=srcArr[3]-0+1,srcArr[2]=stamp,srcArr[5]=srcStr),srcArr.join(".")}},mediav.sendRequest=function(src,callback){var image=new Image(1,1);image.onload=function(){image.onload=null,callback&&callback()},image.src=src,window.mediav["mv_"+(new Date-0)]=image}}catch(e){mediav.test("t3=error1"+e.type)}!function(){function Encode(str){return encodeURIComponent(str)}function Trim(source){return String(source).replace(trimer,"")}function plus(array,i){array[i]=""+(array[i]?1*array[i]+1:1)}function initHostName(){var host=window.location.host;return host}function initCookieHost(){var dom=document.domain;if("www."==dom.substring(0,4))dom=dom.substring(4);else{var doms=dom.split("."),domaintype=doms[doms.length-1];doms.length>2&&isNaN(domaintype-0)&&(doms[0]="",dom=doms.join("."))}return dom}function hash(str){var idx,hash=1,charCode=0;if(str)for(hash=0,idx=str.length-1;idx>=0;idx--)charCode=str.charCodeAt(idx),hash=(hash<<6&268435455)+charCode+(charCode<<14),charCode=266338304&hash,hash=0!=charCode?hash^charCode>>21:hash;return hash}function getVisitorId(){return Math.round(2147483647*Math.random())^2147483647&hash(refer+hostname)}function getInitA(){var now=new Date-0;return[1,getVisitorId(),now,now,now,now,now,0,0,0,0,0]}function getInitB(){var now=new Date-0;return[1,now,0,0,1,0]}function getInitC(){return 1}function getInitTO(){return[0,0,0]}function updateSession(){var now=new Date-0;isNewSession?(qzja[3]=qzja[4],qzja[4]=now,qzjb[4]=1,plus(qzja,11),plus(qzjto,1)):qzjb[4]=0,qzja[5]=qzja[6],qzja[6]=now,plus(qzja,10),plus(qzjb,2),plus(qzjto,0)}function writeCookie(){var jzqc=encodeURIComponent(jzqx||"")+"|"+encodeURIComponent(jzqy||"")+"|"+encodeURIComponent(jzqz||"")+"|"+encodeURIComponent(jzqosr||"")+"|"+(jzqcm||"");jzqc+="|"+encodeURIComponent(qzja.join(".")||""),cookie.set("_jzqco",jzqc,{expires:halfyear,domain:cookieHost,path:"/"})}function sendRequest(param,isT){try{qzjb[5]&&generalData.userName&&(qzja[8]=1,writeCookie());var jzqa=[qzja[0],qzja[1],(qzja[2]+"").substring(0,10),(qzja[3]+"").substring(0,10),(qzja[4]+"").substring(0,10),qzja[10]].join("."),jzqc=["_jzqa="+jzqa];jzqx&&jzqc.push("_jzqx="+jzqx),jzqy&&jzqc.push("_jzqy="+jzqy),jzqz&&jzqc.push("_jzqz="+jzqz),jzqc=encodeURIComponent(jzqc.join(";+")),param=param||[],param.push("type=3&db=none"),isT||(param.push("qzja="+qzja.join("."),"qzjb="+qzjb.join("."),"qzjto="+qzjto.join(".")),param.push("jzqh="+hostname),param.push("jzqpt="+Encode(generalData.pageTitle||document.title)),param.push("jzqre="+Encode(refer)),qzja[7]&&param.push("qzjhn="+qzja[7]),generalData.userId&&param.push("qzjui="+Encode(generalData.userId)),generalData.userName&&param.push("qzjun="+Encode(generalData.userName)),generalData.pageType&&param.push("qzjpt="+Encode(generalData.pageType)),generalData.pageId&&param.push("qzjpi="+Encode(generalData.pageId))),jzqosr&&param.push("jzqosr="+jzqosr),param.push("jzqc="+jzqc),param.push("jzqs="+siteid),param.push("jzqv="+mediav.$version),param[0].indexOf("logtype")<0?param.push("jzqrd="+(window._mv_loader&&window._mv_loader.getRandom&&window._mv_loader.getRandom("mba")||new Date-0)):(generalData.goodsId&&param.push("qzjgoi="+generalData.goodsId),generalData.sign&&param.push(generalData.ss?"qzjcode=":"qzjsign="+generalData.sign),param.push("jzqrd=0"+rad));var paramStr=param.join("&").replace(/%0A|%0D|%09/g,"")}catch(e){mediav.test("t3=err3"+e.type)}var url=("https:"==document.location.protocol?"https://secure.mediav.com/t?":"http://mvp.mediav.com/t?")+paramStr;url.length<2036&&mediav.sendRequest(url,function(){jzqcm&&new Date-0-jzqcm<864e5||(mediav.mkC(),jzqcm=new Date-0,writeCookie()),0!=qzjb[4]&&(qzjb[4]=0,writeCookie())})}function getSign(siteid,go,pageUrl){var str=siteid+go+(pageUrl||"");return hash(str)}function getEcomKey(ecomData,arguName){for(var key=arguName;ecomData[key];)key+=" ";return key}function addEcomAPI(funcName,arguName,arrayKey,sep,callback,check){sep=sep||"|",command[funcName]=function(){if(!callback||callback.apply(window,arguments)!==!0){for(var data=[],argu=check?check.apply(window,arguments):arguments,i=0,l=argu.length;l>i;i++)try{data[i]=null==argu[i]?"0":(argu[i]+"").replace(/\|/g," ")}catch(e){}""==data[data.length-1]&&(data[data.length-1]="-");var value=data.join(sep);"qzjgono"==arguName&&arguments[2]&&(arguName="qzjgo");var key=getEcomKey(ecomData,arguName);ecomKeys.push(key),ecomData[key]=encodeURIComponent(value)}}}var siteid,trimer=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+$)","g"),generalData={},isFirstLog=!0,command=mediav.commands={};mediav.runCmd={push:function(){for(var l=arguments.length,i=0;l>i;i++){var cmdArray=[];Array.prototype.push.apply(cmdArray,arguments[i]);var method=cmdArray.shift();command[method]&&command[method].apply(this.runner,cmdArray)}}},mediav.mkC=function(){var img=new Image(1,1);img.onload=img.onerror=function(){},siteid=siteid.split("-")[1],img.src="http://ckmap.mediav.com/m?tid="+siteid+"&tck=no_tck"};var m=new Date;m.setDate(m.getDate()+1),m.setHours(0),m.setMinutes(0),m.setSeconds(0);var jzqcm,halfyear=(m-new Date,15768e6),rad=new Date-0,refer=document.referrer,hostname=initHostName(),cookieHost=initCookieHost(),cookie=mediav.cookie,qzja=cookie.get("_qzja"),qzjb=cookie.get("_qzjb"),qzjc=cookie.get("_qzjc"),qzjto=cookie.get("_qzjto"),jzqc=cookie.get("_jzqco");if(jzqc){var tmp=jzqc.split("|");qzja=tmp[5]||"",jzqx=tmp[0]||"",jzqy=tmp[1]||"",jzqz=tmp[2]||"",jzqosr=tmp[3]||"",jzqcm=tmp[4],qzja=decodeURIComponent(qzja),jzqx=decodeURIComponent(jzqx),jzqy=decodeURIComponent(jzqy),jzqz=decodeURIComponent(jzqz),jzqosr=decodeURIComponent(jzqosr)}else var jzqx=cookie.get("_jzqx")||"",jzqy=cookie.get("_jzqy")||"",jzqz=cookie.get("_jzqz")||"",jzqosr=cookie.get("_jzqosr")||"";cookieHost&&(mediav.cookie.remove("_qzja"),mediav.cookie.remove("_qzjb"),mediav.cookie.remove("_qzjc"),mediav.cookie.remove("_qzjto"),mediav.cookie.remove("_qzja",{path:"/"}),mediav.cookie.remove("_qzjb",{path:"/"}),mediav.cookie.remove("_qzjc",{path:"/"}),mediav.cookie.remove("_qzjto",{path:"/"})),"/"!=window.location.pathname&&(mediav.cookie.remove("_qzja"),mediav.cookie.remove("_qzjb"),mediav.cookie.remove("_qzjc"),mediav.cookie.remove("_qzjto"));var isNewSession=!qzja||!qzjb||!qzjc;qzja=qzja?qzja.split("."):getInitA(),qzjb=qzjb?qzjb.split("."):getInitB(),qzjc=qzjc||getInitC(),qzjto=qzjto?qzjto.split("."):getInitTO();command.$setAccount=function(sid){siteid=sid,0!=siteid.indexOf("m-")&&(siteid="m-"+siteid+"-0")},command.$setGeneral=function(pageType,pageId,userName,userId,pageTitle){pageType!=generalData.pageType&&(isFirstLog=!0),"goodsdetail"!=pageType&&"cartview"!=pageType||(isFirstLog=!1),pageTitle&&(generalData.pageTyp=pageTitle),generalData.pageType=pageType||"",generalData.pageId=pageId||"",generalData.userName=userName||"",qzja[7]=Encode(userName).replace(/\./g,"_"),generalData.userId=userId||"",("registered"==pageType||1==qzjb[5]&&userName&&1!=qzja[8])&&(command.$logOrder(userId||"rad"+new Date-0,0,userName||"","","","0"),qzja[8]=1,qzjb[5]=1,qzjb[6]=1,writeCookie())},command.$logConversion=function(){isFirstLog&&sendRequest(),isFirstLog=!1},command.$setRef=function(ref){mediav.ref=ref},command.$log=function(params){sendRequest(params,1)},command.$logData=function(extParam){try{for(var params=["logtype=ecom"],goi=[],i=0,l=ecomKeys.length;l>i;i++){var key=ecomKeys[i],value=ecomData[key];"ordercreate"!=generalData.pageType&&"qzjorg"==Trim(key)?(value=value.split("%7C"),goi.push(value[1])):(value&&params.push(Trim(key)+"="+value),"qzjor"==key&&delete ecomData[key],"qzjgo"!=key||generalData.sign||(generalData.sign=getSign(siteid,value,generalData.pageUrl)))}if(goi.length>0&&params.push("qzjgoi="+goi.join(",")),extParam&&params.push(extParam),1==params.length)return;generalData.ref&&params.push("ref="+Encode(generalData.ref)),ecomKeys=[],sendRequest(params)}catch(e){throw e}},command.custom=function(){for(var arguName=arguments[0],argu=arguments,data=[],i=1,l=argu.length;l>i;i++)try{data[i-1]=null==argu[i]?"0":(argu[i]+"").replace(/\|/g," ")}catch(e){}""==data[data.length-1]&&(data[data.length-1]="-");var o=Encode(data.shift()),ot=Encode(data.shift()),value=data.join("|"),key=getEcomKey(ecomData,arguName);ecomKeys.push("jzqval"),ecomData.jzqval=encodeURIComponent(value),command.$logData("&jzqotp=5&jzqt=tran&jzqkey="+key+"&jzqo="+o+"&jzqot="+ot)},command.$logAction=function(actName,param1,param2,param3,param4){qzjb[5]=1,writeCookie();var params=["&qzjecom=1&logtype=ecom"];params.push("qzjregc=1"),sendRequest(params)};var ecomData={},ecomKeys=[];if(addEcomAPI("$addBrand","qzjbr"),addEcomAPI("$addCategory","qzjca"),addEcomAPI("$addGoods","qzjgono",0,null,function(categoryId,brandId,goodsName,goodsId,goodsPrice,goodsImage){if(generalData.pageId=goodsId,generalData.goodsId=goodsId,mediav.ref){var href=document.location.href.split("#")[0],ref=mediav.ref.replace("#{url}",href);generalData.ref=ref}}),addEcomAPI("$addCartGoods","qzjcag",0),addEcomAPI("$addCartPackage","qzjcap",0),addEcomAPI("$addCartPackageGoods","qzjcapg",0),addEcomAPI("$addOrderInner","qzjor",0,null,function(orderid){generalData.pageId=orderid;try{plus(qzja,9),plus(qzjb,3),plus(qzjto,2),writeCookie()}catch(e){}},function(orderId,price,param1,param2,param3,param4){return[orderId,price]}),command.$logOrder=function(orderId,price,param1,param2,param3,param4){orderId+="";var params=["jzqt=tran"];return params.push("jzqo="+Encode(orderId)),params.push("jzqot="+Encode(price)),param1&&params.push("jzqo1="+Encode(param1)),param2&&params.push("jzqo2="+Encode(param2)),param3&&params.push("jzqo3="+Encode(param3)),param4&&params.push("jzqo4="+Encode(param4)),command.$log(params),param4+""=="0"?(qzja[8]=1,void(qzjb[5]=1)):void(""!=orderId&&"0"!=orderId&&(command.$addOrderInner(orderId,price,param1,param2,param3,param4),command.$logData()))},command.$addOrder=command.$logOrder,command.$logItem=function(orderId,sku,name,price,quantity){var params=["jzqt=item"];params.push("jzqo="+Encode(orderId)),params.push("jzqix="+Encode(sku)),params.push("jzqin="+Encode(name)),params.push("jzqip="+Encode(price)),params.push("jzqiq="+Encode(quantity)),command.$log(params)},addEcomAPI("$setPageUrl","qzjurl",0,null,function(url){generalData.pageUrl=url}),addEcomAPI("setPageUrl","qzjurl",0,null,function(url){generalData.pageUrl=url}),addEcomAPI("$addOrderPackage","qzjorp",0),addEcomAPI("$addOrderPackageGoods","qzjorpg",0),addEcomAPI("$addItem","qzjorg",0,null,function(orderId,sku){},function(orderId,sku,name,price,quantity){for(var argus=[],i=0,l=arguments.length;l>i;i++)argus[i]=arguments[i];return argus[4]=argus[4]-0,isNaN(argus[4])&&(argus[4]=0),argus[5]&&0!=argus[5].indexOf("http")&&(argus[5]="http://"+window.location.hostname+argus[5]),"ordercreate"==generalData.pageType&&command.$logItem(orderId,sku,name,price,quantity),argus}),addEcomAPI("$addSearchResult","qzjse"),addEcomAPI("$addComparedGoods","qzjcog",0),addEcomAPI("$addGoodsFavorite","qzjgof",0),addEcomAPI("$addGift","qzjgi",0),addEcomAPI("$addHistory","qzjorg",0),addEcomAPI("$addOrderDetail","qzjord"),addEcomAPI("$addRecentOrderedGoods","qzjreog"),window.mediav._MBAInit=!1,!window.mediav._MBAInit){updateSession(),writeCookie(),window.mediav._MBAInit=!0;var mvq=window._mvq||[];if(window._mv_loader){var mvl=window._mv_loader,q=mvl.cmdList;return mvl.reg(mediav.runCmd,mediav.runCmd.push),void mediav.runCmd.push.apply(mediav.runCmd,q)}mvq instanceof Array&&(mediav.runCmd.push.apply(mediav.runCmd,mvq),window._mvq=mediav.runCmd)}}()}(),function(){function getPid(reg,url){var res,r=new RegExp(reg);return url.replace(r,function(){res=arguments[1]}),res}function getUrlParam(name){var value,reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(reg);return null!=r&&(value=unescape(r[2])),value}var _mvq=window._mvq=window._mvq||[];if(_mvq.push(["$setAccount","m-26049-0"]),window.location.href.indexOf("hotels.ctrip.com/hotel/")>=0){_mvq.push(["$setGeneral","goodsdetail"]);var productId=getPid("hotels.ctrip.com/hotel/(\\w*?\\d+)",window.location.href);if(productId){var listPagePrefix;(listPagePrefix=productId.match(/^\D+/))&&(productId=productId.replace(listPagePrefix,"c")),_mvq.push(["$addGoods","","","",productId,"","","","","","","",""])}}if(window.location.href.indexOf("hotels.ctrip.com/international/")>=0){_mvq.push(["$setGeneral","goodsdetail"]);var productId=getPid("hotels.ctrip.com/international/(.+?).html",window.location.href);productId&&(productId="NWMhotel"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://flights.ctrip.com/booking/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("flights.ctrip.com/booking/(.+?-.+?)-",window.location.href);productId&&(productId=productId.toUpperCase(),_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://flights.ctrip.com/international/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("flights.ctrip.com/international/.*-(.+?-.+?)$",window.location.href);productId&&(productId=productId.split("?")[0].split("-").reverse().join("").toUpperCase(),_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://piao.ctrip.com/dest/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("piao.ctrip.com/dest/(.+?).html",window.location.href);productId&&(productId="NWM"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://taocan.ctrip.com/freetravel/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("taocan.ctrip.com/freetravel/p(.+?).html",window.location.href);productId&&(productId="NWM"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://vacations.ctrip.com/freetravel/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("vacations.ctrip.com/freetravel/p(.+?).html",window.location.href);productId&&(productId="NWM"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://vacations.ctrip.com/grouptravel/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("vacations.ctrip.com/grouptravel/p(.+?).html",window.location.href);productId&&(productId="NWM"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://vacations.ctrip.com/morelinetravel/")>=0){_mvq.push(["$setGeneral","concern"]);var productId=getPid("vacations.ctrip.com/morelinetravel/p(.+?).html",window.location.href);productId&&(productId="NWM"+productId,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}if(window.location.href.indexOf("http://trains.ctrip.com/TrainBooking/")>=0){_mvq.push(["$setGeneral","concern"]);var productId,from=getUrlParam("from"),to=getUrlParam("to");from&&to&&(productId="t_"+from+"_"+to,_mvq.push(["$addGoods","","","",productId,"","","","","","","",""]))}_mvq.push(["$logConversion"]),_mvq.push(["$logData"])}();