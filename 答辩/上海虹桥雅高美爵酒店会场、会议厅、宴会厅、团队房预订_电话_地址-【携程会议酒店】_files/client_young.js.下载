function loginFail(d) { var f = "http://ct.ctrip.com/crptravel/index.aspx?cardno=" + d.uid; var e = ["RiskInputVerifyCode", "RiskControlRule", "BaojieActivedRule", "UIDExitsAfterFindRule", "UIDInvaildRule", "UIDLockedRule", "UIDInBlackListRule", "CheckNullUserName", "CheckNullPassword", "CheckPasswordRule", "statuslock", "canResetPwd", "expireResetPwd", "TicketSecurityRedirect", "Exception", "UnKnowmError", "UIDForbidenRuler", "DynamicPwdError", "DynamicPwdPast", "DynamicPwdIsNull", "DynamicPwdPhoneIsNull", "DyException", "NotService", "CardNotMatch", "NoSuchUserType", "NoSuchSourceId", "CardNotActive", "CannotLogin", "CardPleaseActive", "ResetPasswordByPwdIsNull", "CorpLogin"], b = ["请输入正确验证码！", "用户名或密码错误！", "激活邮件已发至您宝洁邮箱，请点击链接激活！", "用户名或密码错误！", "已经注销的用户！", "您连续输错密码，锁定30分钟！", "很抱歉，携程无法满足您的服务需求！", "缺少用户名！", "缺少密码！", "用户名或密码错误！", "您的登录密码存在风险，请点击“忘记密码”", "可以重置密码！", "临时码过期！", '<![CDATA[<a href="login.aspx" target="_blank">登录页面</a>登录！]]', "系统错误！", "未知错误！", "您帐号已锁定,如有疑问请拨打客服电话！", "请填写正确的动态密码！", "动态密码已失效，请重新获取！", "请输入动态密码！", "请输入手机号！", "出错了，请稍后再试！", "很抱歉，携程无法满足您的服务需求！", "卡号和公司不匹配！", "没有该类用户！", "没有指定渠道！", "卡号未开通！", "该渠道不允许登录！", "请先激活您的卡！", "您的登录密码存在风险，请点击忘记密码！", "请进入商旅首页<a href=" + f + ' target="_blank">登录</a>查询'], a = ["請輸入正確驗證碼！", "用戶名或密碼錯誤！", "啟動郵件已發至您寶潔郵箱，請點選連結啟動！", "用戶名或密碼錯誤！", "已經註銷的用戶！", "您連續丟失錯誤密碼，鎖30分鐘！", "很抱歉，攜程無法滿足您的服務需求！", "缺少用戶名！", "缺少密碼！", "用戶名或密碼錯誤！", "您的登錄密碼存在風險，請點擊“忘記密碼”", "可以重置密碼！", "臨時碼過期！", '<![CDATA[<a href="login.aspx" target="_blank">登錄頁面</a>登錄！]]', "系統錯誤！", "未知錯誤！", "您帳號已鎖定,如有疑問請撥打客服電話！", "請填寫正確的動態密碼！", "動態密碼已失效，請重新獲取！", "請輸入動態密碼！", "請輸入手機號！", "出錯了，請稍後再試！", "很抱歉，攜程無法滿足您的服務需求！", "卡號和公司不匹配！", "沒有該類用戶！", "沒有指定渠道！", "卡號未開通！", "該渠道不允許登錄！", "請先激活您的卡！", "您的登錄密碼存在風險，請點擊忘記密碼！", "請進入商旅首頁<a href=" + f + ' target="_blank">登錄</a>查詢']; var h = function () { var i = window.location.hostname.toLowerCase(); if (i.indexOf(".big5") >= 0 || i.indexOf(".hk") >= 0) { return true } else { return false } }; if (d.rurl) { window.location.href = unescape(d.rurl); return } var j = ""; var g = true; if (d.errmessage) { var c = e.indexOf(d.errmessage); if (c > -1) { if (h()) { j = a[c] } else { j = b[c] } g = false } } if (d.actionName) { var c = e.indexOf(d.actionName); if (c > -1) { if (h()) { j = a[c] } else { j = b[c] } g = false } } if (!!g) { if (!!d.errmessage) { j = decodeURIComponent(escape(d.errmessage)) } } if (j === "") { j = "系统错误" } sso_popLogin.showErrors(d.loginType, j); if (sso_divVerifyCode.style.display != "none" && d.loginType === "0") { returnFlag = true; sso_popLogin.isBlack() } } function getReturn(c) { var b = function (f, e) { var g = new RegExp("(^|&)" + e + "=([^&]*)(&|$)", "i"); var h = f.substr(1).match(g); if (h != null) { return unescape(h[2]) } return null }; var d = b(c, "success"), a = {}; if (d == "T") { a.success = d; a.errmessage = b(c, "errmessage"); a.buttonId = b(c, "buttonId"); a.ticketStr = b(c, "ticketStr"); a.authkey = b(c, "authkey") } else { a.success = d; a.errmessage = b(c, "errmessage"); a.rurl = b(c, "rurl"); a.actionName = b(c, "ActionName"); a.isNeedModifyPwd = b(c, "IsNeedModifyPwd"); a.uid = b(c, "Uid"); a.coopName = b(c, "coopName"); a.verifyCodeFlag = b(c, "VerifyCodeFlag"); a.loginType = b(c, "loginType") } loginResult = a; return a } var $__SSO_ID = function (a) { return document.getElementById(a) }; var sso_maskDIv = $__SSO_ID("sso_maskDIv"), sso_domUser = $__SSO_ID("sso_domUser"), sso_phonePwd = $__SSO_ID("sso_phonePwd"), sso_domUserUl = $__SSO_ID("sso_domUserUl"), sso_phonePwdUl = $__SSO_ID("sso_phonePwdUl"), sso_memberlogin = $__SSO_ID("sso_memberlogin"), sso_txtUid = $__SSO_ID("sso_txtUid"), sso_txtPwd = $__SSO_ID("sso_txtPwd"), sso_chkAutoLogin = $__SSO_ID("sso_chkAutoLogin"), sso_chkAutoLoginDy = $__SSO_ID("sso_chkAutoLoginDy"), sso_imgCode = $__SSO_ID("sso_imgCode"), sso_divVerifyCode = $__SSO_ID("sso_divVerifyCode"), sso_verifyCode = $__SSO_ID("sso_verifyCode"), sso_btnSubmit = $__SSO_ID("sso_btnSubmit"), sso_membererror = $__SSO_ID("sso_membererror"), sso_mobilePhone = $__SSO_ID("sso_mobilePhone"), sso_txtCodePwd = $__SSO_ID("sso_txtCodePwd"), sso_dyPwd = $__SSO_ID("sso_dyPwd"), sso_dyPwdFirst = $__SSO_ID("sso_dyPwdFirst"), sso_divVerifyCodes = $__SSO_ID("sso_divVerifyCodes"), sso_imgCodePhone = $__SSO_ID("sso_imgCodePhone"), sso_reSend = $__SSO_ID("sso_reSend"), sso_btnSubmitLogin = $__SSO_ID("sso_btnSubmitLogin"), sso_dymembererror = $__SSO_ID("sso_dymembererror"), sso_commonlogin = $__SSO_ID("sso_commonlogin"), sso_thirdlogin = $__SSO_ID("sso_thirdlogin"), sso_openCard = $__SSO_ID("sso_openCard"), sso_cardName = $__SSO_ID("sso_cardName"), sso_hidSourceId = $__SSO_ID("sso_hidSourceId"), sso_txtCUid = $__SSO_ID("sso_txtCUid"), sso_txtcPwd = $__SSO_ID("sso_txtcPwd"), sso_btnCSubmit = $__SSO_ID("sso_btnCSubmit"), sso_cardError = $__SSO_ID("sso_cardError"), sso_lkbtnGetPwd = $__SSO_ID("sso_lkbtnGetPwd"), sso_commonerror = $__SSO_ID("sso_commonerror"), sso_noneloginDiv = $__SSO_ID("sso_noneloginDiv"), sso_btnDirectBook = $__SSO_ID("sso_btnDirectBook"), sso_divClose = $__SSO_ID("sso_divClose"), sso_qq = $__SSO_ID("sso_qq"), sso_sina = $__SSO_ID("sso_sina"), sso_nete = $__SSO_ID("sso_nete"), sso_renren = $__SSO_ID("sso_renren"), sso_baidu = $__SSO_ID("sso_baidu"), sso_clogin = $__SSO_ID("sso_clogin"), sso_mlogin = $__SSO_ID("sso_mlogin"), sso_mlogin2 = $__SSO_ID("sso_mlogin2"), sso_tlogin = $__SSO_ID("sso_tlogin"), sso_register = $__SSO_ID("sso_register"), sso_register2 = $__SSO_ID("sso_register2"), sso_ifrprocxy = $__SSO_ID("sso_ifrprocxy"), sso_ie6 = !-[1, ] && !window.XMLHttpRequest, jpIsBlack = false, jpIsBlackForMobile = false, jsptoken = "N", loginResult = {}, riskLevel, sso_phoneCodeLi = $__SSO_ID("sso_phoneCodeLi"); returnFlag = false; (function () { var b = "", a = false; return JSP = { checkIsBlack: function (d) { var e = d.Code; if (e == 295) { sso_popLogin.showErrors(sso_consts.sso_logintype_member, "您帐号已锁定,如有疑问请拨打客服电话。"); sso_divVerifyCode.style.display = "none"; jpIsBlack = "block" } else { if (e == 285) { sso_popLogin.showErrors(sso_consts.sso_logintype_member, "您连续输错密码，锁定30分钟。"); sso_divVerifyCode.style.display = "none"; jpIsBlack = "block" } else { if (e == 1) { sso_divVerifyCode.style.display = "block"; jpIsBlack = "true"; var f = "data:image/gif;base64," + d.Image; var c = d.CaptchaId; sso_imgCode.datahash = c; sso_imgCode.src = f } else { sso_divVerifyCode.style.display = "none"; jpIsBlack = "false" } } } jsptoken = d.jsptoken }, checkIsBlackForMobile: function (d) { var e = d.Code; if (e == 295) { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "您帐号已锁定,如有疑问请拨打客服电话。"); sso_phoneCodeLi.style.display = "none"; $__SSO_ID("sso_phoneLoginTip").style.display = "none"; jpIsBlackForMobile = "block" } else { if (e == 285) { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "您连续输错密码，锁定30分钟。"); sso_phoneCodeLi.style.display = "none"; $__SSO_ID("sso_phoneLoginTip").style.display = "none"; jpIsBlackForMobile = "block" } else { if (e == 1) { sso_phoneCodeLi.style.display = "block"; jpIsBlackForMobile = "true"; var f = "data:image/gif;base64," + d.Image; var c = d.CaptchaId; sso_imgCodePhone.datahash = c; sso_imgCodePhone.src = f } else { sso_phoneCodeLi.style.display = "none"; jpIsBlackForMobile = "false" } } } jsptoken = d.jsptoken }, checkVerifyCode: function (c) { a = c.code === "1" }, getImageCode: function (c) { b = c.code; sso_imgCode.src = sso_Config.url.verifyCodeUrl + "?" + b }, getImageCodePhone: function (c) { b = c.code; sso_imgCodePhone.src = sso_Config.url.verifyCodePhoneUrl + "?" + b }, sendDyncPwd: function (c) { if (c.code != "5") { sso_popLogin.isBlackForMobile() } switch (c.code) { case "1": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPhone); sso_mobilePhone.focus(); return; case "2": case "3": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "用户未注册"); sso_mobilePhone.focus(); return; case "5": sso_popLogin.showErrors(sso_consts.sso_logintype_phone); $__SSO_ID("sso_phoneLoginTip").style.display = consts.display.block; sso_popLogin.countDownPhone(); sso_dyPwdFirst.focus(); break; case "7": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyverycode); sso_txtCodePwd.focus(); break; case "8": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "验证码错误"); sso_txtCodePwd.value = ""; sso_txtCodePwd.focus(); break; case "9": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "动态密码获取频繁，请一分钟后再试"); $__SSO_ID("sso_phoneLoginTip").style.display = consts.display.none; break; case "285": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "您连续输错密码，锁定30分钟"); break; case "295": sso_popLogin.showErrors(sso_consts.sso_logintype_phone, "您帐号已锁定,如有疑问请拨打客服电话。"); break; case "0": case "4": default: sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_WaitForTry); return } } } })(); function sso_member_enter() { var a = arguments.callee.caller.arguments[0] || window.event; if (a.keyCode == 13) { a.returnValue = false; sso_btnSubmit.click() } return false } function sso_phone_enter() { var a = arguments.callee.caller.arguments[0] || window.event; if (a.keyCode == 13) { a.returnValue = false; sso_btnSubmitLogin.click() } return false } function sso_card_enter() { var a = arguments.callee.caller.arguments[0] || window.event; if (a.keyCode == 13) { a.returnValue = false; sso_btnCSubmit.click() } return false } function getChannelName(b) { var e = Alliances.split("@"); for (var a = 0; a < e.length; a++) { var d = e[a].length > 0 ? e[a].split("||") : null; if (d == null) { continue } var c = d[1].split("|")[0]; if (c == b) { return d[0] } } return null } function isPwd1(a) { return /^\S{4,20}$/.test(a) } var sso_popLogin = { init: function () { this.binder(); sso_txtUid.onclick = function () { if (sso_txtUid.value == "" || sso_txtUid.value == sso_consts.sso_tip_name) { sso_txtUid.value = "" } sso_txtUid.style.color = "black" }; sso_popLogin.sso_showTip(sso_mobilePhone, sso_consts.sso_tip_mobile); sso_popLogin.sso_showTip(sso_txtCodePwd, sso_consts.sso_tip_verycode); sso_popLogin.sso_showTip(sso_cardName, sso_consts.sso_tip_cardname); sso_popLogin.sso_showTip(sso_txtCUid, sso_consts.sso_tip_name); sso_popLogin.sso_showTip(sso_verifyCode, sso_consts.sso_tip_verycode) }, binder: function () { this.onuidblur(); this.onbtnclick(); this.onthridlogin(); this.onrefreshvcode(); this.onrefreshPhonevcode(); $__SSO_ID("sso_corpLogin").onclick = function (a) { a = a || window.event; if (a.stopPropagation) { a.stopPropagation() } else { a.cancelBubble = true } } }, onbtnclick: function () { sso_register.onclick = sso_register2.onclick = function () { window.open(sso_consts.rootUrl + "/member/emailregist.aspx") }; sso_mlogin.onclick = sso_mlogin2.onclick = function () { sso_memberlogin.style.display = "block"; sso_commonlogin.style.display = "none"; sso_thirdlogin.style.display = "none"; var a = $__SSO_ID("selectCardName"); if (a) { a.style.display = "none" } var b = $__SSO_ID("searchCardName"); if (b) { b.style.display = "none" } }; sso_clogin.onclick = function () { if (typeof (Alliances) === "undefined") { var b = document.createElement("script"); b.type = "text/javascript"; b.async = false; b.src = sso_Config.jsonpUrl.getChannelData; var a = document.getElementsByTagName("head")[0]; a.appendChild(b) } sso_memberlogin.style.display = "none"; sso_commonlogin.style.display = "block"; sso_thirdlogin.style.display = "none"; $ss.bind(sso_cardName, "sso_hidSourceId") }; sso_tlogin.onclick = function () { sso_thirdlogin.style.display = "block"; sso_memberlogin.style.display = "none"; sso_commonlogin.style.display = "none" }; $__SSO_ID("sso_memberRadio").onclick = function () { sso_domUserUl.style.display = "block"; sso_phonePwdUl.style.display = "none"; $__SSO_ID("sso_memberRadio").checked = true }; $__SSO_ID("sso_cardRadio").onclick = function () { sso_popLogin.onmobileblur(); sso_domUserUl.style.display = "none"; sso_phonePwdUl.style.display = "block"; $__SSO_ID("sso_cardRadio").checked = true }; sso_divClose.onclick = function () { sso_popLogin.showErrors(sso_consts.sso_logintype_member); sso_popLogin.showErrors(sso_consts.sso_logintype_card); sso_popLogin.showErrors(sso_consts.sso_logintype_phone); sso_maskShow(null, true) }; sso_btnDirectBook.onclick = function () { sso_popLogin.submitLogin("N", "N", "", "F", sso_consts.sso_logintype_quick) }; sso_reSend.onclick = sso_popLogin.SendSmsByLogin; sso_btnSubmit.onclick = function () { var c = sso_txtUid.value, a = sso_txtPwd.value, f = encodeURI(sso_verifyCode.value), b = sso_imgCode.datahash; autolog = "F", valid_status = true; var d = function (h, g, i) { if (h) { if (h === sso_consts.sso_tip_name || sso_trim(h) === "") { sso_popLogin.showErrors(sso_consts.sso_logintype_member, sso_consts.sso_error_emptyuid); sso_txtUid.focus(); return false } } else { sso_popLogin.showErrors(sso_consts.sso_logintype_member, sso_consts.sso_error_emptyuid); return false } if (jpIsBlack === "block") { return false } if (!g) { sso_popLogin.showErrors(sso_consts.sso_logintype_member, sso_consts.sso_error_emptypwd); sso_txtPwd.focus(); return false } return true }; var e = function () { if (valid_status) { sso_popLogin.hideErrors(); if (sso_chkAutoLogin.checked) { autolog = "T" } sso_popLogin.submitLogin(c, a, f || "", autolog, sso_consts.sso_logintype_member, b) } }; valid_status = d(c, a, f); if (valid_status) { if (sso_divVerifyCode.style.display != "none") { if (f) { if (f === encodeURI(sso_consts.sso_tip_verycode) || sso_trim(f) === "") { sso_popLogin.showErrors(sso_consts.sso_logintype_member, sso_consts.sso_error_emptyverycode); sso_verifyCode.focus(); return } else { sso_popLogin.showErrors(sso_consts.sso_logintype_member); e() } } else { sso_popLogin.showErrors(sso_consts.sso_logintype_member, sso_consts.sso_error_emptyverycode); sso_verifyCode.focus(); return } } else { e() } } }; sso_btnSubmitLogin.onclick = function () { $__SSO_ID("sso_phoneLoginTip").style.display = "none"; var c = sso_mobilePhone.value, a = sso_dyPwdFirst.value, g = sso_txtCodePwd.value, f = "F", b = true; var d = function (i, h) { if (i) { if (!isMobile_SSO(sso_trim(i))) { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_wrongPhone); return false } if (i === sso_consts.sso_tip_mobile || sso_trim(i) === "") { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPhone); return false } } else { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPhone); return false } if (jpIsBlackForMobile === "block") { return false } if (!h || h === sso_consts.sso_tip_dyncpwd || sso_trim(h) === "") { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPwd); return false } return true }; var e = function () { if (b) { sso_popLogin.hideErrors(); if (sso_chkAutoLoginDy.checked) { f = "T" } sso_popLogin.submitLogin(c, a, g || "", f, sso_consts.sso_logintype_phone) } }; b = d(c, a); if (b) { e() } }; sso_openCard.onclick = function () { if ((sso_cardName.value === sso_consts.sso_tip_cardname ? "" : sso_cardName.value).length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptyCardName); return } else { sso_popLogin.showErrors(sso_consts.sso_logintype_card); var a = sso_hidSourceId.value; logn(a) } }; sso_lkbtnGetPwd.onclick = function () { if ((sso_cardName.value === sso_consts.sso_tip_cardname ? "" : sso_cardName.value).length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptyCardName); return false } if ((sso_txtCUid.value === sso_consts.sso_tip_name ? "" : sso_txtCUid.value).length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptyuid); return false } else { var b = "tmp_" + parseInt(Math.random() * 1000000, 10); var a = sso_Config.jsonpUrl.checkCoCard + "?sourceid=" + sso_hidSourceId.value + "&cardno=" + sso_txtCUid.value + "&tmp=" + Math.floor(Math.random() * 1000) + "&jsonp=" + b; sso_popLogin.jsonpRequest(a); window[b] = function (e) { if (e.code === "F") { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_wrongUid); return false } else { var c = "tmp_" + parseInt(Math.random() * 1000000, 10); var d = sso_Config.jsonpUrl.AjaxGetCoCardUid + "?sourceid=" + sso_hidSourceId.value + "&cardno=" + sso_txtCUid.value + "&tmp=" + Math.floor(Math.random() * 1000) + "&jsonp=" + c; sso_popLogin.jsonpRequest(d); window[c] = function (f) { if (f.code === "ssof") { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_wrongUid); return false } else { window.location.href = "https://accounts.ctrip.com/member/PassWord/VerifyUserInfo.aspx?uid=" + f.code } } } } } }; sso_btnCSubmit.onclick = function () { if ((sso_cardName.value === sso_consts.sso_tip_cardname ? "" : sso_cardName.value).length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptyCardName); return false } if ((sso_txtCUid.value === sso_consts.sso_tip_name ? "" : sso_txtCUid.value).length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptyuid); return false } else { var b = "tmp_" + parseInt(Math.random() * 1000000, 10); var a = sso_Config.jsonpUrl.checkCoCard + "?sourceid=" + sso_hidSourceId.value + "&cardno=" + sso_txtCUid.value + "&tmp=" + Math.floor(Math.random() * 1000) + "&jsonp=" + b; window[b] = function (c) { if (c.code === "F") { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_wrongUid); return false } else { if (sso_txtcPwd.value.length === 0) { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_emptypwd); return false } else { if (isPwd1(sso_txtcPwd.value)) { sso_popLogin.showErrors(sso_consts.sso_logintype_card) } else { sso_popLogin.showErrors(sso_consts.sso_logintype_card, sso_consts.sso_error_wrongPwd); return false } sso_popLogin.showErrors(sso_consts.sso_logintype_card); sso_popLogin.submitLogin(sso_txtCUid.value, sso_txtcPwd.value, "", "F", sso_consts.sso_logintype_card) } } }; sso_popLogin.jsonpRequest(a) } } }, onthridlogin: function () { var f = sso_Config.thirdUrl.popalipay, b = sso_Config.thirdUrl.popqq, d = sso_Config.thirdUrl.popweibo, a = sso_Config.thirdUrl.popnete, e = sso_Config.thirdUrl.poprenren, c = sso_Config.thirdUrl.popbaidu; openwin = function (j, m, i, k, g) { window.open(j + "?DivMaskFlagBackUrl=" + sso_popLogin.getProcxyUrl(), "newwindow", "height=" + m + ",width=" + i + ",top=" + k + ",left=" + g + ",toolbar=no,menubar=no,scrollbars=no, resizable=yes,location=no, status=no") }; sso_qq.onclick = function () { openwin(b, 600, 800, 300, 300) }; sso_sina.onclick = function () { openwin(d, 600, 800, 300, 300) }; sso_nete.onclick = function () { openwin(a, 600, 800, 300, 300) }; sso_renren.onclick = function () { openwin(e, 600, 800, 200, 300) }; sso_baidu.onclick = function () { openwin(c, 600, 800, 300, 300) } }, onrefreshvcode: function () { sso_imgCode.onclick = function () { sso_popLogin.isBlack(); sso_verifyCode.focus() } }, onrefreshPhonevcode: function () { sso_imgCodePhone.onclick = function () { sso_popLogin.isBlackForMobile(); sso_txtCodePwd.focus() } }, onuidblur: function () { sso_txtUid.onblur = function () { sso_popLogin.isBlack() } }, onmobileblur: function () { sso_mobilePhone.onblur = function () { sso_popLogin.isBlackForMobile() } }, gettmp: function (b, a) { return b + "tmp=" + Math.floor(Math.random() * a) }, jsonpRequest: function (c, d, a) { var b = document.createElement("script"); b.type = "text/javascript"; b.async = d || false; b.src = c; document.body.insertBefore(b, document.body.firstChild) }, getCookie: function (a) { if (document.cookie.length > 0) { c_start = document.cookie.indexOf(a + "="); if (c_start != -1) { c_start = c_start + a.length + 1; c_end = document.cookie.indexOf(";", c_start); if (c_end == -1) { c_end = document.cookie.length } return unescape(document.cookie.substring(c_start, c_end)) } } return "" }, setCookie: function (b, c, a) { var d = new Date(); d.setDate(d.getDate() + a); document.cookie = b + "=" + escape(c) + ((a == null) ? "" : ";expires=" + d.toGMTString()) }, isLogin: function (c) { var d = ""; d = sso_popLogin.getCookie("ticket_ctrip"); if (d === "") { d = sso_popLogin.getCookie("ticket%5Fctrip") } if (d === "") { SSO_NotLoginCallBack(c) } else { var a = "tmp_" + parseInt(Math.random() * 1000000, 10); var b = sso_Config.jsonpUrl.checkLoginStatus + "?ticketStr=" + encodeURIComponent(d) + sso_popLogin.gettmp("&", 1000) + "&jsonp=" + a; window[a] = function (e) { if (e.code != "T") { SSO_NotLoginCallBack(c) } else { sso_hideMask() } }; sso_popLogin.jsonpRequest(b, false) } }, isLoginByAuth: function (c) { var d = ""; d = sso_popLogin.getCookie("authkey"); var e = ""; e = sso_popLogin.getCookie("ticket_ctrip"); if (e === "") { e = sso_popLogin.getCookie("ticket%5Fctrip") } if (d === "" && e === "") { SSO_NotLoginCallBack(c) } else { var a = "tmp_" + parseInt(Math.random() * 1000000, 10); var b = sso_Config.jsonpUrl.checkLoginStatus + "?akey=" + encodeURIComponent(d) + "&ticketStr=" + encodeURIComponent(e) + sso_popLogin.gettmp("&", 1000) + "&jsonp=" + a; window[a] = function (f) { if (f.code != "T") { SSO_NotLoginCallBack(c) } else { sso_hideMask() } }; sso_popLogin.jsonpRequest(b, false) } }, createIframe: function (d) { if (sso_ie6 && d) { var e = document.createElement("iframe"), a = d.clientWidth + 10, b = d.clientHeight + 10; e.style.cssText = "display:none;_display:block;position:absolute;top:0;left:-5;z-index:-1;filter:mask();width:" + a + "px;height:" + b + "px;"; if (!document.body) { var c = document.createElement("body"); document.appendChild(c) } d.appendChild(e) } }, SendSmsByLogin: function () { if (jpIsBlackForMobile === "block") { return false } sso_popLogin.hideDynamicErrors(); $__SSO_ID("sso_phoneLoginTip").style.display = "none"; sso_dyPwdFirst.value = ""; var b = sso_mobilePhone.value, e = sso_txtCodePwd.value, a = true; var c = function (f, g) { if (f) { if (!isMobile_SSO(sso_trim(f))) { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_wrongPhone); return false } if (f === sso_consts.sso_tip_mobile || sso_trim(f) === "") { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPhone); return false } } else { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyDyncPhone); return false } if ($__SSO_ID("sso_phoneCodeLi").style.display == "block" && (!g || g === sso_consts.sso_tip_verycode || sso_trim(g) === "")) { sso_popLogin.showErrors(sso_consts.sso_logintype_phone, sso_consts.sso_error_emptyverycode); sso_txtCodePwd.value = ""; sso_txtCodePwd.focus(); return false } return true }; a = c(b, e); if (a) { var d = sso_Config.jsonpUrl.sendDyncPwd + sso_popLogin.gettmp("&", 1000) + "&mobile=" + b + "&vcode=" + escape(e) + "&captchaID=" + sso_imgCodePhone.datahash; sso_popLogin.jsonpRequest(d) } }, countDownPhone: function () { sso_reSend.onclick = function () { return false }; sso_reSend.className = "lg_btn3_disabled"; countDown(60, function () { if (sso_reSend.value) { sso_reSend.value = "发送动态密码" } else { sso_reSend.innerHTML = "发送动态密码" } sso_reSend.className = "lg_btn3"; sso_reSend.onclick = sso_popLogin.SendSmsByLogin }, sso_reSend, "秒后重发") }, sso_showTip: function (b, a) { b.onfocus = b.onclick = function () { if (b.value == "" || b.value == a) { b.value = "" } b.style.color = "black"; b.focus() }; b.onblur = function () { if (b.value == "" || b.value == a) { b.value = a; b.style.color = "gray" } } }, showErrors: function (a, b) { if (a == sso_consts.sso_logintype_member) { sso_popLogin.showMemberErrors(b) } if (a == sso_consts.sso_logintype_card) { sso_popLogin.showCommonErrors(b) } if (a == sso_consts.sso_logintype_phone) { sso_popLogin.showDynamicErrors(b) } }, showMemberErrors: function (a) { if (a) { $__SSO_ID("sso_domErrorli").style.display = "block"; sso_membererror.innerHTML = "<i class='lg_ico_alert'></i>" + a; sso_membererror.style.visibility = "visible" } else { $__SSO_ID("sso_domErrorli").style.display = "none"; sso_membererror.style.visibility = "hidden" } }, showCommonErrors: function (a) { if (a) { sso_cardError.style.display = consts.display.block; sso_commonerror.style.visibility = consts.visibility.visible; sso_commonerror.innerHTML = "<i class='lg_ico_alert'></i>" + a } else { sso_cardError.style.display = "none"; sso_commonerror.style.visibility = "hidden" } }, showDynamicErrors: function (a) { if (a) { $__SSO_ID("sso_phoneLoginErr").style.display = "block"; sso_dymembererror.innerHTML = "<i class='lg_ico_alert'></i>" + a; sso_dymembererror.style.visibility = "visible" } else { $__SSO_ID("sso_phoneLoginErr").style.display = "none"; sso_dymembererror.style.visibility = "hidden" } }, hideErrors: function () { $__SSO_ID("sso_domErrorli").style.display = "none"; sso_membererror.style.visibility = "hidden" }, hideDynamicErrors: function () { $__SSO_ID("sso_phoneLoginErr").style.display = "none"; sso_dymembererror.style.visibility = "hidden" }, getProcxyUrl: function () { var b = $__SSO_ID("sso_loginprocxyPath"); if (b) { return b.value } else { var c = window.location.pathname.substring(1); var a = c == "" ? "" : c.substring(0, c.indexOf("/")); return window.location.protocol + "//" + window.location.host + "/" + a + "/" + "loginprocxy.html" } }, isBlack: function () { if (!returnFlag) { sso_popLogin.hideErrors() } else { returnFlag = false } var a = sso_txtUid.value; if (a) { if (a === sso_consts.sso_tip_name || sso_trim(a) === "") { sso_txtUid.value = sso_consts.sso_tip_name; sso_txtUid.style.color = "gray"; return } if (a.length <= 60) { sso_verifyCode.value = sso_consts.sso_tip_verycode; sso_verifyCode.style.color = "gray"; this.jsonpRequest(sso_Config.jsonpUrl.checkIsBlack + this.gettmp("&", 1000) + "&username=" + a) } else { this.showErrors(sso_consts.sso_logintype_member, "登陆名最多只能输入60个字符") } } else { sso_txtUid.value = sso_consts.sso_tip_name; sso_txtUid.style.color = "gray" } return jpIsBlack }, isBlackForMobile: function () { sso_popLogin.hideDynamicErrors(); var a = sso_mobilePhone.value; if (a) { sso_txtCodePwd.value = sso_consts.sso_tip_verycode; sso_txtCodePwd.style.color = "gray"; this.jsonpRequest(sso_Config.jsonpUrl.checkIsBlackForMobile + this.gettmp("&", 1000) + "&username=" + a) } else { sso_mobilePhone.value = sso_consts.sso_tip_mobile; sso_phoneCodeLi.style.display = "none"; sso_mobilePhone.style.color = "gray" } return jpIsBlackForMobile }, showVcode: function (a) { if (a) { sso_divVerifyCode.style.display = "block"; var c = "tmp_" + parseInt(Math.random() * 1000000, 10); var b = sso_Config.jsonpUrl.simpleValidateCode + "?t=div&resultLevel=" + riskLevel + "&tmp=" + Math.round(Math.random() * 10000) + "&jsonp=" + c; window[c] = function (e) { if (e.code == "1") { var f = "data:image/gif;base64," + e.imageStr; var d = e.captcbaid; sso_imgCode.datahash = d; sso_imgCode.src = f } }; sso_popLogin.jsonpRequest(b) } else { sso_divVerifyCode.style.display = "none" } }, showPhoneVcode: function (a) { if (a) { sso_phoneCodeLi.style.display = "block"; var c = "tmp_" + parseInt(Math.random() * 1000000, 10); var b = sso_Config.jsonpUrl.simpleValidateCode + "?resultLevel=" + riskLevel + "&tmp=" + Math.round(Math.random() * 10000) + "&jsonp=" + c; window[c] = function (e) { if (e.code == "1") { var f = "data:image/gif;base64," + e.imageStr; var d = e.captcbaid; sso_imgCodePhone.datahash = d; sso_imgCodePhone.src = f } }; sso_popLogin.jsonpRequest(b) } else { sso_phoneCodeLi.style.display = "none" } }, IsCardNum: function (a) { return /^[0-9][0-9]{7}|^[0-9][0-9]{9}$/.test(a) }, submitLogin: function (c, d, a, i, b, k) { var f = sso_popLogin.getProcxyUrl() + sso_popLogin.gettmp("?", 10000), g = sso_ifrprocxy.contentDocument || sso_ifrprocxy.contentWindow.document, e = g.createElement("form"); if (!g.body) { var h = document.createElement("body"); g.appendChild(h) } var j = function (m, o, n) { var l = g.createElement("input"); l.id = l.name = o; l.value = n; m.appendChild(l) }; e.name = "NewPostLogin"; e.action = sso_Config.jsonpUrl.login + sso_popLogin.gettmp("&", 1000); e.method = "POST"; j(e, "buttonId", sso_buttonID); if (3 == b) { j(e, "sem", "NoneLogin") } j(e, "signin_uid", c); j(e, "signin_pwd", d); j(e, "txtCode", a); j(e, "vcodeID", k); j(e, "IsAuto", i); j(e, "NewSSO", "T"); j(e, "NewSSOBackURL", f); j(e, "NewSSOToken", jsptoken); if (sso_consts.sso_logintype_card == b) { j(e, "sso_hidSourceId", sso_hidSourceId.value) } j(e, "NewSSOLoginType", b); g.body.appendChild(e); e.submit() } }; sso_popLogin.init();